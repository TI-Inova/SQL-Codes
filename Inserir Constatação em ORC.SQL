DECLARE 

 

    CURSOR C_ORC010_NROSERIEINT IS  

    SELECT ORC010_NROSERIEINT, ORC010_LINHA, ORC010_ID 

    FROM ORTBC001, ORTBC010 

    WHERE ORC010_ORC001_ID = ORC001_ID 

      AND ORC001_ORDEM =  

      AND ROWNUM <= 1 

      AND ORC010_NROSERIEINT NOT IN (SELECT ORC010_NROSERIEINT 

                                     FROM ORTBC001, ORTBC010, ORTBC012 

                                     WHERE ORC010_ORC001_ID = ORC001_ID 

                                       AND ORC012_ORC001_ID = ORC001_ID 

                                       AND ORC012_ORC010_ID = ORC010_ID 

                                       AND ORC001_ORDEM = ); 

    

    V_ORC010_NROSERIEINT ORTBC010.ORC010_NROSERIEINT%TYPE; 

    V_ORC010_LINHA ORTBC010.ORC010_LINHA%TYPE; 

     

    V_ORC012_ORC010_ID ORTBC012.ORC012_ORC010_ID%TYPE; 

 

BEGIN 

 

    OPEN C_ORC010_NROSERIEINT; 

     

    LOOP 

         

        FETCH C_ORC010_NROSERIEINT INTO V_ORC010_NROSERIEINT, V_ORC010_LINHA, V_ORC012_ORC010_ID; 

        EXIT WHEN C_ORC010_NROSERIEINT%NOTFOUND; 

         

        INS_DEBUG(V_ORC012_ORC010_ID||' - '||'ORC'||' - '||||' - '||V_ORC010_LINHA||' - '||V_ORC010_NROSERIEINT); 

         

        INSERT INTO ORTBC012(ORC012_ID, ORC012_ORC001_ID, ORC012_ORC010_ID, ORC012_GRUPO, ORC012_EMPRESA, ORC012_FILIAL, ORC012_TIPODOC, ORC012_ORDEM, ORC012_LINHA, ORC012_CONSTATACAO, ORC012_TAB164_ID, DATE_CREATED, DATE_MODIFIED, MODIFIED_BY, CREATED_BY)  

        VALUES(0, , V_ORC012_ORC010_ID, 1, 1, 0, 'ORC', , V_ORC010_LINHA, , , SYSDATE, NULL, NULL, 'LUCASC'); 

         

        V_ORC012_ORC010_ID := V_ORC012_ORC010_ID + 1; 

     

    END LOOP; 

     

    CLOSE C_ORC010_NROSERIEINT; 

 

END; 