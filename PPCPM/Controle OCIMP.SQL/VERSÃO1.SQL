SELECT OCB001_ORDCOMPRA ORDEM, 
        OCB001_LINHA LINHA, 
        OCA001_FORNECEDOR||'-'||PPA001_NOME FORNECEDOR, 
        OCB001_PRODUTO||'-'||OCB001_PRODUTOCONF PRODUTO, 
        OCB001_PRODDESC DESCRICAO, 
        OCB001_QTDESOL QTD_SOL, 
        OCB001_VLRTOTAL VALOR, 
        OCB001_QTDEABE QTD_ABERTO, 
        OCB001_PRECOLIQUIDO * OCB001_QTDEABE VALOR_ABERTO, 
        OCA001_DTEMISSAO EMISSAO, 
        OCB001_DTENTREGASOL ENTR_SOL, 
        OCB001_DTENTREGAPREV ENTR_PREV 
 
FROM OCTBB001, OCTBA001, PPTBA001 
 
WHERE OCB001_TIPODOC = OCA001_TIPODOC 
  AND OCB001_ORDCOMPRA = OCA001_ORDCOMPRA 
  AND OCB001_FILIAL = OCA001_FILIAL 
  AND PPA001_PESSOA = OCA001_FORNECEDOR 
  AND OCB001_SITUACAO = OCB001_SITUACAO 
 
  AND OCA001_DTEMISSAO BETWEEN :DTINI AND :DTFIM 
  AND OCB001_ORDCOMPRA LIKE NVL (:ORDEM,'%') 
  AND OCB001_PRODUTO LIKE NVL (:PRODUTO,'%') 
 
  AND OCB001_SITUACAO = 1 
  AND OCA001_TIPODOC LIKE 'OCIMP' 
 
ORDER BY OCB001_ORDCOMPRA