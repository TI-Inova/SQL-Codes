SELECT NIVEL, 
        COMPONENTE, 
        DESCRICAO_COMPONENTE, 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 1)  + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 2) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 14) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 17) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 43) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 77) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, COMPONENTE, 0, 88) ESTOQUE_COMPONENTE, 
        PRODUTO, 
        DESCRICAO_PRODUTO, 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 1) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 2) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 14) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 17) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 43) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 77) + 
        ESPGA002.ESFPA002003(GRUPO, EMPRESA, 0, PRODUTO, 0, 88) ESTOQUE_PRODUTO 
 
FROM 
 
(SELECT ECB001_GRUPO GRUPO, 
        ECB001_EMPRESA EMPRESA, 
        LEVEL NIVEL, 
        ECB001_COMPONENTE COMPONENTE, 
        CQFBA019(ECB001_GRUPO, ECB001_EMPRESA, ECB001_COMPONENTE, 0) DESCRICAO_COMPONENTE, 
        ECB001_PRODUTO PRODUTO, 
        CQFBA019(ECB001_GRUPO, ECB001_EMPRESA, ECB001_PRODUTO, 0) DESCRICAO_PRODUTO, 
        ECB001_QTDE QTD, 
        ECB001_UM UM, 
        ECPGA001.ECFPA001004 (LEVEL, TO_CHAR(ECB001_ORDEM, '999999') || TO_CHAR(ECB001_SEQCOMP, '999999'), '0') ECB001_ORDEM 
 
FROM ECTBB001 
 
WHERE TRUNC(SYSDATE) BETWEEN ECB001_DTVALINI AND ECB001_DTVALFIM 
 
  START WITH ECB001_COMPONENTE = :COMPONENTE 
  AND TRUNC(SYSDATE) BETWEEN ECB001_DTVALINI AND ECB001_DTVALFIM 
 
  CONNECT BY PRIOR ECB001_PRODUTO = ECB001_COMPONENTE 
  AND TRUNC(SYSDATE) BETWEEN ECB001_DTVALINI AND ECB001_DTVALFIM) 
 
WHERE NIVEL NOT IN (1) 