SELECT DECODE(PVA002_PRODUTOCONFG, 0, PVA002_PRODUTOG, PVA002_PRODUTOG||'-'||PVA002_PRODUTOCONFG) PRODUTO, 
        CQFBA019(PVA002_GRUPO, PVA002_EMPRESA, PVA002_PRODUTOG, PVA002_PRODUTOCONFG) DESCRICAO, 
         
        NULL PESO, 
        NULL PERCENTUAL, 
        PVA002_DATAINI DATAINI, 
        PVA002_DATAFIM DATAFIM, 
         
        TO_CHAR(PVA002_PRODUTOG, 99999999)||TO_CHAR(0, 99999999) SEQUENCIA 
 
FROM PVTBA002 
 
WHERE TO_CHAR(PVA002_PRODUTOG||'-'||PVA002_PRODUTOCONFG) LIKE NVL(:PRODUTO_ORIGEM, '%') 
  AND TO_CHAR(PVA002_PRODUTO||'-'||PVA002_PRODUTOCONF) LIKE NVL(:PRODUTO_DESTINO, '%') 
  AND PVA002_DATAINI BETWEEN :PERIODO 
 
UNION 
 
SELECT DECODE(PVA002_PRODUTOCONF, 0, PVA002_PRODUTO, PVA002_PRODUTO||'-'||PVA002_PRODUTOCONF)PRODUTO, 
        CQFBA019(PVA002_GRUPO, PVA002_EMPRESA, PVA002_PRODUTO, PVA002_PRODUTOCONF) DESCRICAO, 
         
        PVA002_PESO PESO, 
        PVA002_PERCENTUAL PERCENTUAL, 
        NULL DATAINI, 
        NULL DATAFIM, 
         
        TO_CHAR(PVA002_PRODUTOG, 99999999)||TO_CHAR(PVA002_PERCENTUAL, 99999999)||TO_CHAR(PVA002_PRODUTO, 99999999) SEQUENCIA 
 
FROM PVTBA002 
 
WHERE TO_CHAR(PVA002_PRODUTOG||'-'||PVA002_PRODUTOCONFG) LIKE NVL(:PRODUTO_ORIGEM, '%') 
  AND TO_CHAR(PVA002_PRODUTO||'-'||PVA002_PRODUTOCONF) LIKE NVL(:PRODUTO_DESTINO, '%') 
  AND PVA002_DATAINI BETWEEN :PERIODO 
 
ORDER BY SEQUENCIA 