DECLARE 

 

    CURSOR C_ORC010_NROSERIEINT IS  

    SELECT ORC010_NROSERIEINT, ORC010_LINHA, ORC010_ID 

    FROM ORTBC001, ORTBC010 

    WHERE ORC010_ORC001_ID = ORC001_ID 

      AND ORC001_ORDEM =  

      AND ROWNUM <= 1 

      AND ORC010_NROSERIEINT NOT IN (SELECT ORC010_NROSERIEINT 

                                     FROM ORTBC001, ORTBC010, ORTBC011 

                                     WHERE ORC010_ORC001_ID = ORC001_ID 

                                       AND ORC011_ORC001_ID = ORC001_ID 

                                       AND ORC011_ORC010_ID = ORC010_ID 

                                       AND ORC001_ORDEM = ); 

    

    V_ORC010_NROSERIEINT ORTBC010.ORC010_NROSERIEINT%TYPE; 

    V_ORC010_LINHA ORTBC010.ORC010_LINHA%TYPE; 

     

    V_ORC011_ORC010_ID ORTBC011.ORC011_ORC010_ID%TYPE; 

 

BEGIN 

 

    OPEN C_ORC010_NROSERIEINT; 

     

    LOOP 

         

        FETCH C_ORC010_NROSERIEINT INTO V_ORC010_NROSERIEINT, V_ORC010_LINHA, V_ORC011_ORC010_ID; 

        EXIT WHEN C_ORC010_NROSERIEINT%NOTFOUND;  

         

        INS_DEBUG(V_ORC011_ORC010_ID||' - '||'ORC'||' - '||||' - '||V_ORC010_LINHA||' - '||V_ORC010_NROSERIEINT); 

         

        INSERT INTO ORTBC011(ORC011_ID, ORC011_ORC001_ID, ORC011_ORC010_ID, ORC011_GRUPO, ORC011_EMPRESA, ORC011_FILIAL, ORC011_TIPODOC, ORC011_ORDEM, ORC011_LINHA, ORC011_RELATO, ORC011_TAB163_ID, DATE_CREATED, DATE_MODIFIED, MODIFIED_BY, CREATED_BY)  

        VALUES(0, , V_ORC011_ORC010_ID, 1, 1, 0, 'ORC', , V_ORC010_LINHA, , , SYSDATE, NULL, NULL, 'LUCASC'); 

         

        V_ORC011_ORC010_ID := V_ORC011_ORC010_ID + 1; 

     

    END LOOP; 

     

    CLOSE C_ORC010_NROSERIEINT; 

 

END; 