SET SERVEROUTPUT ON; 

 

DECLARE 

 

    CURSOR C_ESA008_PRODUTO IS  

    SELECT ESA008_PRODUTO 

    FROM ESTBA008, 

    WHERE ESA022_GRUPO = ESA008_GRUPO 

       AND ESA022_EMPRESA = ESA008_EMPRESA 

       AND ESA022_PRODUTO = ESA008_PRODUTO 

       AND ESA008_AREA =  

       AND ESA008_FAMILIA =  

       AND ESA008_GRUPOPROD =  

       AND ESA008_SUBGRUPO =  

    GROUP BY ESA008_PRODUTO; 

      

    V_ESA008_PRODUTO ESTBA008.ESA008_PRODUTO%TYPE; 

    V_ESA022_ID ESTBA022.ESA022_ID%TYPE; 

    

BEGIN 

    

    OPEN C_ESA008_PRODUTO; 

    

    SELECT MAX(ESA022_ID) + 1 

    INTO V_ESA022_ID 

    FROM ESTBA022; 

    

    LOOP 

     

        FETCH C_ESA008_PRODUTO INTO V_ESA008_PRODUTO; 

        EXIT WHEN C_ESA008_PRODUTO%NOTFOUND; 

     

        INSERT INTO ESTBA022 (ESA022_ID, ESA022_GRUPO, ESA022_EMPRESA, ESA022_PRODUTO, ESA022_TEMPLATE, ESA022_TEE001_ID, DATE_CREATED, DATE_MODIFIED, MODIFIED_BY, CREATED_BY)  

        VALUES (V_ESA022_ID, , , V_ESA008_PRODUTO, , , , NULL, NULL, 'SCRIPT'); 

     

            

        V_ESA022_ID := V_ESA022_ID + 1; 

 

    END LOOP; 

 

END; 